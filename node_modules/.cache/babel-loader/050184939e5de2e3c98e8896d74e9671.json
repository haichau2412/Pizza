{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport UserServices from '../../service/UserServices';\nexport const authUser = createAsyncThunk('auth/authUserStatus', async (info, {\n  getState,\n  requestId\n}) => {\n  const {\n    currentRequestId,\n    authenticating\n  } = getState().auth;\n\n  if (authenticating === false || requestId !== currentRequestId) {\n    return;\n  }\n\n  const data = await UserServices.authUser(info);\n  return { ...data,\n    username: info.values.username\n  };\n});\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState: {\n    currentRequestId: '',\n    currentUser: '',\n    authenticating: false,\n    authenticated: false,\n    token: '',\n    msg: ''\n  },\n  reducers: {\n    resetMsg: (state, action) => {\n      console.log('aaaa');\n      state.msg = '';\n    }\n  },\n  extraReducers: {\n    [authUser.pending]: (state, action) => {\n      if (state.authenticating === false) {\n        state.authenticating = true;\n        state.currentRequestId = action.meta.requestId;\n      }\n    },\n    [authUser.fulfilled]: (state, action) => {\n      const {\n        requestId\n      } = action.meta;\n      console.log(action.payload);\n      const {\n        msg,\n        username,\n        token\n      } = action.payload;\n\n      if (state.authenticating === true && state.currentRequestId === requestId) {\n        state.authenticating = false;\n        state.currentRequestId = undefined;\n        state.currentUser = '';\n      }\n\n      if (msg) {\n        state.msg = msg;\n      } else if (token) {\n        state.currentUser = username;\n        state.authenticated = true;\n        state.token = token;\n      }\n    },\n    [authUser.rejected]: (state, action) => {\n      const {\n        requestId\n      } = action.meta;\n\n      if (state.authenticating === true && state.currentRequestId === requestId) {\n        state.authenticating = false;\n        state.currentRequestId = undefined;\n        state.currentUser = '';\n      }\n    }\n  }\n});\nconst {\n  actions,\n  reducer\n} = authSlice;\nexport const {\n  resetMsg\n} = actions;\nexport default reducer;","map":{"version":3,"sources":["/home/chau1246/Documents/pizza/src/App/redux/auth/AuthSlice.js"],"names":["createSlice","createAsyncThunk","UserServices","authUser","info","getState","requestId","currentRequestId","authenticating","auth","data","username","values","authSlice","name","initialState","currentUser","authenticated","token","msg","reducers","resetMsg","state","action","console","log","extraReducers","pending","meta","fulfilled","payload","undefined","rejected","actions","reducer"],"mappings":"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","sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport UserServices from '../../service/UserServices';\n\nexport const authUser = createAsyncThunk(\n    'auth/authUserStatus',\n    async (info, { getState, requestId }) => {\n        const { currentRequestId, authenticating } = getState().auth;\n        if (authenticating === false || requestId !== currentRequestId) {\n            return\n        }\n        const data = await UserServices.authUser(info);\n        return { ...data, username: info.values.username };\n    }\n)\n\n\nexport const authSlice = createSlice({\n    name: 'auth',\n    initialState: {\n        currentRequestId: '',\n        currentUser: '',\n        authenticating: false,\n        authenticated: false,\n        token: '',\n        msg: '',\n    },\n    reducers: {\n        resetMsg: (state, action) => {\n            console.log('aaaa')\n            state.msg = '';\n        }\n    },\n    extraReducers: {\n        [authUser.pending]: (state, action) => {\n            if (state.authenticating === false) {\n                state.authenticating = true;\n                state.currentRequestId = action.meta.requestId;\n            }\n        },\n        [authUser.fulfilled]: (state, action) => {\n            const { requestId } = action.meta\n            console.log(action.payload);\n            const { msg, username, token } = action.payload;\n            if (state.authenticating === true && state.currentRequestId === requestId) {\n                state.authenticating = false\n                state.currentRequestId = undefined\n                state.currentUser = ''\n            }\n\n            if (msg) {\n                state.msg = msg;\n            } else if (token) {\n                state.currentUser = username;\n                state.authenticated = true;\n                state.token = token;\n            }\n        },\n        [authUser.rejected]: (state, action) => {\n            const { requestId } = action.meta\n            if (state.authenticating === true && state.currentRequestId === requestId) {\n                state.authenticating = false;\n                state.currentRequestId = undefined;\n                state.currentUser = ''\n            }\n\n        },\n    }\n});\n\n\nconst { actions, reducer } = authSlice;\n\nexport const { resetMsg } = actions;\n\nexport default reducer;\n\n"]},"metadata":{},"sourceType":"module"}